Pipeline: SnpEff → Autoencoder → Classification



This folder contains the full pipeline for generating latent representations from SnpEff-annotated VCF files and training both classical ML models and contrastive-learning-based models.



1. generate_snpeff_latent.py
Purpose: Extract variant-level features from SnpEff-annotated VCF files, build one-hot encoded matrices, introduce denoising noise, and train a denoising autoencoder.
The script outputs one latent representation per sample. These embeddings are used as input to downstream ML and contrastive-learning models.
Key features:
a. Parses VCF records, extracts relevant annotation fields
b. One-hot encodes variant attributes and adds noise to create (noisy, original) pairs
d. Trains a denoising autoencoder (OptimizedAutoencoder class)
e. Aggregates latent vectors, produces a per-sample embedding and saves latent embeddings to CSV


2. train_classical_models.py
Purpose: Train machine and deep learning models on the latent vectors generated by the autoencoder.
Models implemented:
a. Logistic Regression
b. Random Forest
c. XGBoost (GPU-accelerated)
d. SVM (GPU-based PyTorch version when available)
e. LSTM
f. GRU
g. FCNN
h. Transformer
What it does:
a. Performs 10-fold cross-validation
b. Reports accuracy + log-loss mean and std
c. Generates plots summarizing model performance


3. contrastive_learning.py
Purpose: Implements a PyTorch contrastive learning pipeline (NT-Xent loss) as an alternative representation-learning method. Demonstrates advanced self-supervised learning applied to genomic feature embeddings.
Core functions:
a. Data augmentations (noise, scaling, flips)
b. Encoder + projection head
c. Training loop with validation accuracy tracking, and downstream evaluation via logistic regression




Input Requirements:
1. SnpEff-annotated VCF files
2. Metadata file containing sample IDs & ASD labels
3. Output directory for embeddings and trained model metrics

How to run:
CUDA_VISIBLE_DEVICES=1 python3 /mnt/data/train_classical_models.py
CUDA_VISIBLE_DEVICES=1 python3 /mnt/data/generate_snpeff_latent.py
CUDA_VISIBLE_DEVICES=1 python3 /mnt/data/contrastive_learning.py

Outputs:
1. latent_embeddings.csv (or similar)
2. Plots of ML model accuracy/loss
3. Plots of contrastive training curves
